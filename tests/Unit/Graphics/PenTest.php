<?php

declare(strict_types=1);

namespace VCL\Tests\Unit\Graphics;

use PHPUnit\Framework\TestCase;
use VCL\Graphics\Pen;
use VCL\Graphics\Enums\PenStyle;

class PenTest extends TestCase
{
    private Pen $pen;

    protected function setUp(): void
    {
        $this->pen = new Pen();
    }

    public function testDefaultColor(): void
    {
        $this->assertSame('#000000', $this->pen->Color);
    }

    public function testColorProperty(): void
    {
        $this->pen->Color = '#FF0000';
        $this->assertSame('#FF0000', $this->pen->Color);
    }

    public function testDefaultWidth(): void
    {
        $this->assertSame(1, $this->pen->Width);
    }

    public function testWidthProperty(): void
    {
        $this->pen->Width = 5;
        $this->assertSame(5, $this->pen->Width);
    }

    public function testWidthMinimumIsOne(): void
    {
        $this->pen->Width = 0;
        $this->assertSame(1, $this->pen->Width);
    }

    public function testDefaultStyle(): void
    {
        $this->assertEquals(PenStyle::Solid, $this->pen->Style);
    }

    public function testStyleProperty(): void
    {
        $this->pen->Style = PenStyle::Dash;
        $this->assertEquals(PenStyle::Dash, $this->pen->Style);
    }

    public function testModifiedAfterChange(): void
    {
        $this->pen->resetModified();
        $this->pen->Color = '#0000FF';
        $this->assertTrue($this->pen->isModified());
    }

    public function testAssignTo(): void
    {
        $this->pen->Color = '#123456';
        $this->pen->Width = 3;
        $destPen = new Pen();
        $this->pen->assignTo($destPen);
        $this->assertSame('#123456', $destPen->Color);
        $this->assertSame(3, $destPen->Width);
    }

    public function testIsPersistent(): void
    {
        $this->assertInstanceOf(\VCL\Core\Persistent::class, $this->pen);
    }
}
